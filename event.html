<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
  </head>
  <body>
    <u-parent></u-parent>
  </body>

  <script>
    class Parent extends HTMLElement {
      constructor() {
        super()
        this.root = this.attachShadow({ mode: 'open' })
      }
      connectedCallback() {
        this.render()
      }
      render() {
        this.container = document.createElement('div')
        this.container.innerHTML = `
        <button>父组件</button>
        <u-child></u-child>
        `
        const style = document.createElement('style')

        style.textContent = `
            div{
                width: 100px;
                height: 100px;
                border:1px solid red;
            }
        `

        this.root.appendChild(this.container)
        this.root.appendChild(style)

        let btn = this.root.querySelector('button')
        btn.addEventListener('click', () => {
         let child = this.root.querySelector('u-child')
         child.shadowRoot.host.addBgColor('red')
        })
      }
      addBgColor(color) {
        console.log(color)
        this.container.style.backgroundColor = color
      }
    }

    class Child extends HTMLElement {
      constructor() {
        super()
        this.root = this.attachShadow({ mode: 'open' })
        this.root.innerHTML = `
            <style>
                
            div{
                width: 50px;
                height: 50px;
                border:1px solid green;
            }    
            </style>
         <div>子组件</div>
        `
        
      }
      connectedCallback() {
        console.dir(this.parentNode)
      }
      addBgColor(color) {
        console.log(color)
        this.root.querySelector('div').style.backgroundColor = color
      }
    }
    customElements.define('u-child', Child)
    customElements.define('u-parent', Parent)
  </script>
</html>
